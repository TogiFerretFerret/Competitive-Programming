IOI 国の鉄道をすべて所有していた大富豪の JOI 氏が逝去した．鉄道は遺言に従って分割相続されるこ
とになった．
IOI 国には N 個の都市と，それらの間を結ぶ M 本の鉄道がある．都市には 1 から N までの番号が付け
られ，鉄道には 1 から M までの番号が付けられている．鉄道 i は都市 Ai と都市 Bi の間を双方向に結び，
また年間に Ci 円の収益を上げている．鉄道の利用客数や乗車料金は多様なため，C1, . . . , CM はそれぞれ相
異なる．同じ二つの都市を結ぶ鉄道が複数あるかもしれない．
遺言には以下のように鉄道の分割相続の方法が記されていた．
• 鉄道は，JOI 氏の K 人の子供に相続させる．子供たちには年齢が高い順に 1 から K までの番号が付
いている．
• それぞれの子供は，M 本の鉄道のうちのいくつか ( 0 本の場合もありうる ) を相続する．
• はじめに M 本の鉄道の中から，子供 1 がいくつか選び，自分の相続分とする．次に残った鉄道の中
から，子供 2 が自分の相続分を決める．以下同様にして，K 人の子供が順番に，自分の相続分を決
めていく．
• どの子供も，すでに相続先が決まった鉄道は相続することができない．すなわち，子供 j の相続分の
中に鉄道 i が含まれていたら，それより若い子供 k (k > j) は鉄道 i を自分の相続分の中に含めること
ができない．
• どの子供も，自分の相続分を決める際，相続分がサイクルを含まないようにしなければならない．す
なわち，鉄道 i1, i2, . . . , im (i1, i2, . . . , im は相異なる) を一回ずつ利用することである都市から出発して
同じ都市に戻ってくることができるとき，どの子供も，鉄道 i1, i2, . . . , im をすべて一人で相続するこ
とはできない．
• 誰にも相続されずに残った鉄道は IOI 国に寄贈される．
どの子供も，父に似て貪欲であるため，相続する鉄道の年間収益の合計ができるだけ大きくなるように
自分の相続分を選ぶ．どの子供についても，年間収益の合計が最大となるような相続分の選び方は，ただ
一通りであることが証明できる．それぞれの鉄道が誰に相続されるかを求めよ．
課題
IOI 国の鉄道の情報と，JOI 氏の子供の人数が与えられたとき，それぞれの鉄道が誰に相続されるかを求
めるプログラムを作成せよ．
